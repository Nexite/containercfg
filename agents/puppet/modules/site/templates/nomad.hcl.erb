datacenter = "srnd"
data_dir = "/opt/nomad"

vault {
  enabled = true
  address = "http://vault.srnd.cloud:8200"
}

telemetry {
  publish_allocation_metrics = true
  publish_node_metrics       = true
  datadog_address = "localhost:8125"
  disable_hostname = true
  collection_interval = "10s"
}

client = {
  enabled = true
  options = {
    "docker.auth.config" = "/root/.docker/config.json"
    "docker.auth.helper" = "gcr"
    "docker.volumes.enabled" = true
  }
  meta {
    "nomad_volumes" = "<%= @host_volumes.keys.sort_by!{ |m| m.downcase}.join(',') %>"
  }
  host_volume "acme" {
    path     = "/acme"
    read_only = false
  }
  <% @host_volumes.each do |tag, mountpoint| %>
    host_volume "<%= tag %>" {
      path = "/data-disks/<%= tag %>"
      read_only = false
    }
  <% end %>
}
